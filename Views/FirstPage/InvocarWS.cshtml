
@model app.Models.Provider;
@{
    ViewBag.Title = "Evoke existing Web Service";
    <!-- var entidades = ViewBag.Entidades; -->
    //Layout = "~/Views/Shared/_Layout.cshtml";
    Layout = "";
    <!-- var valueEntidade = " ";
    var test = ""; -->
}

<!DOCTYPE html>

<html>
<head>
<h2>@ViewBag.Title</h2>
<style>
table, th, td 
{
  border: 1px solid black;
  border-collapse: collapse;
}

</style>
</head>
<body>
  <div class="row">
    <form asp-action="InvocarWS" asp-controller="FirstPage" method="post">
      <div class="form-group row">

        <label class="control-label">URL: </label>
        <input asp-for="url" placeholder="Web Service URL here"/>

        <label class="control-label">Entity: </label>
        <select asp-for="selected_table_name" asp-items="@new SelectList(Model.table_names)">
          <option value = null>--Select Entity--</option>
        </select> 
      </div>

      <div class="form-group">
        <input type="submit" value="Mapping" name="map" id="map">
      </div>
      

      <div class="form-group row">
      @if ((@Model.selected_table_name != null) && (@Model.url != null) && (@Model.validResponse == true))
      {
        <!-- <h1>Resposta @Model.validateResponse</h1> --> //validacao json/xml
        <!-- <p>@Model.dataWs</p> -->
        @if(@Model.isJson || @Model.isXml) //entra se a resposta for formato json ou xml
        {
          @foreach (var item in @Model.fieldsWs)
          {
            <label class="control-label">@item ------------> </label>
            <select asp-for="columnsSelected" asp-items="@(new SelectList(Model.columns))">
            </select>
            <br/>
          }
          @foreach (var i in @Model.dataFieldWs)
          {
            <p>@i</p>
          }
        }
     
      }
      else if( (@Model.selected_table_name != null) || (@Model.url != null))
      {
        <h2>selecionar ambos os campos</h2>
      }
    </div>
    
    @if(@Model.mapButton && @Model.selected_table_name != null)
    {
    <div>
      <input type="submit" value="Result" name="Submit" id="result">
    </div>
    }
   
    @if(@Model.submitButton)
    {
      @if(@Model.counterRow > 1)
      {
        <p>@Model.counterRow rows affected on table @Model.selected_table_name :</p>
      }
      else
      {
        <p>@Model.counterRow row affected on table @Model.selected_table_name :</p>
      }

      <table style="width:50%">
        <tr>
        @for(var column = 0; column < @Model.columnNumber; column++)
        {
          <th>@Model.columns[column]</th>
        }
        </tr>
        @for(var row = 0; row < @Model.dataFinalCount; row+=0)
        {
          <tr>
            @for(var value = 0; value < @Model.columnNumber; value++)
            {
            <td>@Model.dataFinal[row++]</td>
            }
          </tr>
        }
      </table> 
    }

    </form>
    
  </div>

</body>


